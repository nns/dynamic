!!! 5
html
	head
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
		link(rel='stylesheet', href='/stylesheets/style.css')
		script(src='/javascripts/jquery.min.js')
		script(src='/javascripts/jquery-ui.min.js')
		script(src='/javascripts/notifications.js')
		script('text/javascript',src='/socket.io/socket.io.js')
		script
			$(function(){
				if(localStorage){
					if(localStorage.user){
						$('#user').val(localStorage.user);
					}
				}
				var socket = io.connect('#{id}');
				socket.on('msg',function(data){
					var commenthtml  = '<div>';
						commenthtml += '	<span style="font-size:2em;color:green;">' + data.user + '</span>';
						commenthtml += '	<span>' + data.date.toLocaleString() + '</span>';
						commenthtml += '</div>';
						commenthtml += '<p style="font-size:2em">' + data.text + '</p>';
						
					var commentelm = $('<div>').addClass('msgDiv');
					
					commentelm.html(commenthtml);
					var msg = $('#msg');
					msg.prepend(commentelm);
					commentelm.slideToggle();
				});
				socket.on('counter',function(count){
					$('#counter').text(count);
				});
				
				$('#button').click(function(e){
					var self = this;
					if(self.noop){
						return false;
					}
					var user = $('#user');
					var text = $('#text');
					if(user.val()){
						if(localStorage){
							if(localStorage.user !== user.val()){
								localStorage.user = user.val();
							}
							
						}
						socket.emit('send',{user:user.val(),text:text.val()});
						text.val('');
					} else {
						self.noop = true;
						user.effect('highlight','fast',function(){
							self.noop = false;
						});
					}
				});
			});
	body
		p#counter
		#content
			#puts(style='width:100%')
				input#user(type="text")
			textarea#text
			input#button.button(type="button",value="send")
			#msg.msg